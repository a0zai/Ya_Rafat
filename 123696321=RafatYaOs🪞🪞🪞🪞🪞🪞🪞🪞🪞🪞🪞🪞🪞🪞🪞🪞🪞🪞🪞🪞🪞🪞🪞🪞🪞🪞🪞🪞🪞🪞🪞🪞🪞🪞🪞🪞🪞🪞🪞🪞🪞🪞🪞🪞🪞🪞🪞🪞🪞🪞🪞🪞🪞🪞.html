<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>A∞Z | Mirror Interface</title>
<style>
  body {
    background: url('IMG_9055.jpeg') no-repeat center center fixed;
    background-size: cover;
    color: #00ffcc;
    font-family: "Courier New", Courier, monospace;
    padding: 2em;
    overflow: hidden;
    backdrop-filter: brightness(0.7);
  }
  #output { display: none; }
</style>
</head>
<body>
  <div id="output"></div>
  <button id="startBtn" style="padding:10px 20px; font-size:16px;">Start</button>

<script>
const startBtn = document.getElementById('startBtn');

function loadVoices() {
  return new Promise(resolve => {
    let voices = speechSynthesis.getVoices();
    if (voices.length) {
      resolve(voices);
    } else {
      speechSynthesis.onvoiceschanged = () => {
        voices = speechSynthesis.getVoices();
        resolve(voices);
      };
    }
  });
}

function speak(text) {
  return new Promise(resolve => {
    if (!text) return resolve();

    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'en-US';
    utterance.rate = 0.6;
    utterance.pitch = 0.4;

    utterance.onend = () => resolve();
    utterance.onerror = () => resolve();

    speechSynthesis.speak(utterance);
  });
}

async function getIPData() {
  try {
    const response = await fetch("https://ipapi.co/json/");
    if (!response.ok) throw new Error("IP API Error");
    return await response.json();
  } catch {
    return null;
  }
}

async function getGeolocation() {
  return new Promise((resolve, reject) => {
    if (!navigator.geolocation) {
      reject("Geolocation not supported.");
    } else {
      navigator.geolocation.getCurrentPosition(
        position => resolve(position.coords),
        error => reject(error.message)
      );
    }
  });
}

async function main() {
  startBtn.disabled = true;
  await loadVoices();

  // جلب بيانات IP
  let ipInfo = await getIPData();

  // جلب إحداثيات GPS (الإذن مطلوب)
  let gpsCoords = null;
  try {
    gpsCoords = await getGeolocation();
  } catch (e) {
    // ممكن المستخدم رفض الإذن أو خطأ
  }

  const now = new Date();
  const timeString = now.toLocaleString();

  const ua = navigator.userAgent;
  const width = window.screen.width;
  const height = window.screen.height;
  const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;

  let ip = ipInfo?.ip || "Unavailable";
  let city = ipInfo?.city || "Unavailable";
  let region = ipInfo?.region || "Unavailable";
  let country = ipInfo?.country_name || "Unavailable";

  // إعداد النصوص مع البيانات الحقيقية
  const lines = [
    "Welcome to A infinity Z mirror interface",
    "Session ID is " + btoa(ip + ua).slice(0,16),
    "The current time is " + timeString,
    "The IP address is " + ip,
    "The user lives in " + city,
    "The region is " + region,
    "The country is " + country,
    "The user is using device " + ua,
    "Screen resolution is " + width + " by " + height,
    "The timezone is " + timezone,
    "Latitude is " + (gpsCoords ? gpsCoords.latitude.toFixed(6) : "Unavailable"),
    "Longitude is " + (gpsCoords ? gpsCoords.longitude.toFixed(6) : "Unavailable")
  ];

  for (const line of lines) {
    await speak(line);
    await new Promise(r => setTimeout(r, 600));
  }
}

startBtn.addEventListener('click', () => {
  startBtn.style.display = 'none';
  main();
});
</script>
</body>
</html>