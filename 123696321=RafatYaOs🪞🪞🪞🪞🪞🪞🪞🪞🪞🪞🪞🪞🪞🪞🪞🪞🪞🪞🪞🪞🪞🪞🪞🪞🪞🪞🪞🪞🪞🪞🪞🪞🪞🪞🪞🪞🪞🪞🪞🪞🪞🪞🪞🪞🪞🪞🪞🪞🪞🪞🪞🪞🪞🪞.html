<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mirror Terminal Lite</title>
<style>
  body {
    background: #001f1f;
    color: #00ffcc;
    font-family: monospace, monospace;
    margin: 0; padding: 0;
    display: flex;
    flex-direction: column;
    height: 100vh;
  }
  #terminal {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
  }
  #commandInput {
    border: none;
    padding: 12px;
    font-size: 18px;
    width: 100%;
    box-sizing: border-box;
    background: #002b2b;
    color: #00ffcc;
    outline: none;
  }
  .cmd-line {
    margin-bottom: 4px;
    white-space: pre-wrap; /* يحافظ على الفراغات والأسطر */
  }
  .cmd-user {
    color: #ffaa00;
  }
</style>
</head>
<body>

<div id="terminal"></div>
<input id="commandInput" type="text" placeholder="Enter command and press Enter..." autocomplete="off" autofocus />

<script>
  const terminal = document.getElementById("terminal");
  const input = document.getElementById("commandInput");

  const baseLines = [
    "🪞",
    "   ▓",
    " ▓ R ▓",
    "   ▓",
    "[R] Root system initialized...",
    "   ▓",
    " ▓ A ▓",
    "   ▓",
    "[A] Access protocol engaged...",
    "   ▓",
    " ▓ F ▓",
    "   ▓",
    "[F] Framework structure generated...",
    "   ▓",
    " ▓ A ▓",
    "   ▓",
    "[A] Activation signal confirmed...",
    "   ▓",
    " ▓ T ▓",
    "   ▓",
    "[T] Transfer in progress...",
    "   ▓",
    " ▓ Y ▓",
    "   ▓",
    "  \\      .  ",
    "  \\    .   .  ",
    "  \\  .   1   .  ",
    "  \\.           .  ",
    "\\.      2      .  ",
    " \\ .           .  ",
    "  \\  .   3   .  ",
    "    \\  .   .  ",
    "     \\   .  ",
    "|.       | ",
    "  /      .  ",
    "   /   .   .  ",
    "   / .   6   .  ",
    "  /.           .  ",
    "/.      9      .  ",
    "/  .           .  ",
    "/    .   6   .  ",
    "/      .   .  ",
    "/       .  ",
    "|.        |",
    " •       .  ",
    " •     .   .  ",
    " •  .   3   .  ",
    " • .           .  ",
    "•.      2      .  ",
    " • .           .  ",
    "  •  .   1   .  ",
    "   •  .   .  ",
    " •      .  ",
    "[Y] Yielding identity signature...",
    "   ▓",
    " ▓ A ▓",
    "   ▓",
    "[A] Authorization granted...",
    "   ▓",
    " ▓ O ▓",
    "   ▓",
    "[O] Operating core systems...",
    "   ▓",
    " ▓ S ▓",
    "   ▓",
    "[S] System secured. Execution complete.",
    "Response: Live signal online.",
    "Awaiting world🚀..."
  ];

  // استدعاء الخطوط تدريجياً عند بداية التشغيل
  let i = 0;
  function showBaseLines() {
    if(i < baseLines.length) {
      const div = document.createElement("div");
      div.className = "cmd-line";
      div.textContent = baseLines[i];
      terminal.appendChild(div);
      terminal.scrollTop = terminal.scrollHeight;
      i++;
      setTimeout(showBaseLines, 300);
    }
  }

  // ذاكرة رمزية محفوظة في localStorage
  const symbolicMemory = JSON.parse(localStorage.getItem("symbolicMemory") || "{}");

  // تنفيذ أوامر التعلم البسيطة
  function handleLearningCommand(input) {
    if(input.startsWith("learn ")) {
      const parts = input.split(" ");
      if(parts.length < 3) return "Usage: learn <command> <response>";
      const cmd = parts[1];
      const response = parts.slice(2).join(" ");
      symbolicMemory[cmd] = response;
      localStorage.setItem("symbolicMemory", JSON.stringify(symbolicMemory));
      return `Learned command "${cmd}" with response: "${response}"`;
    }
    return null;
  }
const commandMap = {
  "hi": "Hello, Rafat here! 👋",
  "help": "Available commands: hi, help, about, learn, recall, clear",
  "about": "This is Mirror Terminal, a symbolic AI interface by Rafat."
};
  // تفسير الإدخال
  function interpretInput(input) {
    const lowerInput = input.toLowerCase();

    const learnResult = handleLearningCommand(lowerInput);
    if(learnResult) return learnResult;

    if(symbolicMemory[lowerInput]) return symbolicMemory[lowerInput];

    if(lowerInput === "clear") {
      terminal.innerHTML = "";
      return "Terminal cleared.";
    }

    if(lowerInput === "recall") {
      let res = "🧠 Learned commands:\n";
      for(let key in symbolicMemory) {
        res += `${key} → ${symbolicMemory[key]}\n`;
      }
      return res.trim();
    }

    return `⚠️ Unknown command: "${input}"`;
  }

  // إضافة سطر جديد مع تمرير تلقائي
  function appendLine(text, className="cmd-line") {
    const div = document.createElement("div");
    div.className = className;
    div.textContent = text;
    terminal.appendChild(div);
    terminal.scrollTop = terminal.scrollHeight;
  }

  // حدث الضغط على إنتر في حقل الإدخال
  input.addEventListener("keydown", function(e) {
    if(e.key === "Enter") {
      const cmd = input.value.trim();
      if(!cmd) return;

      appendLine("> " + cmd, "cmd-line cmd-user");
      const response = interpretInput(cmd);
      appendLine(response);

      input.value = "";
    }
  });

  // بدء عرض الخطوط الأساسية
  showBaseLines();
</script>

</body>
</html>